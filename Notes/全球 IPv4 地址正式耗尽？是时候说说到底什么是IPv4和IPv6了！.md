2019年11月25日，负责英国、欧洲、中东和部分中亚地区互联网资源分配的欧洲网络协调中心（RIPE NCC）宣布，其最后的 IPv4 地址空间储备池在 11 月 25 日 UTC + 1 15:35 完全耗尽，所有 43 亿个 IPv4 地址已分配完毕。

其实，早在20世纪80年代后期开始，全球已经开始意识到这个问题将会发生。IPv6的研发及布署，主要就是为了解决这个问题。

# 什么是IPv4？

IPv4是Internet Protocol version 4的缩写，中文翻译为互联网通信协议（TCP/IP协议）第四版，通常简称为网际协议版本4。

IPv4使用32位（4字节）地址，因此地址空间中只有4,294,967,296（2^32） 个地址。

IPv4地址可被写作任何表示一个32位整数值的形式，但为了方便人类阅读和分析，它通常被写作点分十进制的形式，即四个字节被分开用十进制写出，中间用点分隔。

所以，通常IPv4地址的地址格式为nnn.nnn.nnn.nnn，如：192.168.1.255

因为在点分十进制的表达形式下，共有4个字节的IP地址被分位四段，每一段就有一个字节，而一个字节有8位，那么，8位能表示的数字范围是 0 - 255。

![image](https://github.com/foxliang/Blog/blob/master/images/Ipv4.jpeg)

所以，一个IPv4的地址，格式为nnn.nnn.nnn.nnn，其中 0<=nnn<=255，而每个 n 都是十进制数。可省略前导零。

# 什么是IPv6？

IPv6是Internet Protocol version 6的缩写，中文翻译为互联网通信协议（TCP/IP协议）第6版，通常简称为网际协议版6。

IPv6具有比IPv4大得多的编码地址空间，用它来取代IPv4主要是为了解决IPv4地址枯竭问题，同时它也在其他方面对于IPv4有许多改进。

Pv6具有比IPv4大得多的编码地址空间。这是因为IPv6采用128位的地址，而IPv4使用的是32位。
因此新增的地址空间支持2^128 个地址，具体数量为340,282,366,920,938,463,463,374,607,431,768,211,456个（不知道有没有人能把这个数读出来？）

有人说IPv6的地址数可能比全世界的沙子还要多，足以解决目前IPv4地址量不足的问题。

IPv6二进位制下为128位长度，以16位为一组，每组以冒号“:”隔开，可以分为8组

![image](https://github.com/foxliang/Blog/blob/master/images/Ipv6.png)

IPv6文本格式为 xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx，其中每个 x 都是十六进制数，表示 4 位。例如：

2001:0db8:86a3:08d3:1319:8a2e:0370:7344

## IPv4 VS IPv6

![image](https://github.com/foxliang/Blog/blob/master/images/IPv4vsIPv6.png)


#### 地址

IPv4长度为 32 位（4 个字节）。

IPv4 地址的文本格式为 nnn.nnn.nnn.nnn，其中 0<=nnn<=255，而每个 n 都是十进制数。可省略前导零。最大打印字符数为 15 个，不计掩码。

IPv6长度为 128 位（16 个字节）。

IPv6 地址的文本格式为 xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx，其中每个 x 都是十六进制数，表示 4 位。可省略前导零。可在地址的文本格式中使用一次双冒号（::），用于指定任意数目的 0 位。例如，::ffff:10.120.78.40 表示 IPv4 映射的 IPv6 地址。

#### 地址解析协议

IPv4 使用 ARP 来查找与 IPv4 地址相关联的物理地址（如 MAC 或链路地址）。

IPv6 使用因特网控制报文协议版本 6（ICMPv6）将这些功能嵌入到 IP 自身作为无状态自动配置和邻节点发现算法的一部分。因此，不存在类似于 ARP6 之类的东西。

#### IP 报头

IPv4根据提供的 IP 选项，有 20-60 个字节的可变长度。

IPv6的报文头是 40 个字节的固定长度。没有 IP 报头选项。通常，IPv6 报头比 IPv4 报头简单。

#### 安全性

IPv6预设有IPSec，来提升安全性。相较之下，IPv4的IPSec则需要额外开发。

#### 地址类型

IPv4 地址分为三种基本类型：单点广播地址、多点广播地址和广播地址。

IPv6 地址分为三种基本类型：单点广播地址、多点广播地址和任意广播地址。有关描述，请参阅 IPv6 地址类型。

#### 专用地址和公用地址

IPv4除由 IETF RFC 1918 指定为专用的三个地址范围 10…

(10/8)、172.16.0.0 至 172.31.255.255 (172.16/12) 和 192.168.. (192.168/16) 之外，所有 IPv4 地址都是公用的。专用地址域通常在组织内部使用。专用地址不能通过因特网路由。

IPv6 有类似的概念，但还有重要差别。地址是公用或临时的，先前称为匿名地址。请参阅 RFC 3041。与 IPv4 专用地址不同，临时地址可进行全局路由。动机也不一样：IPv6 临时地址要在它开始通信时屏蔽其客户机的身份（涉及隐私）。临时地址的生存期有限，且不包含是链路（MAC）地址的接口标识。它们通常与公用地址没有区别。

相比IPv4,IPv6主要有以下几个方面的优点

- 1.更大的地址空间。IPv4中规定IP地址长度为32，即有2^32 -1个地址。而IPv6中IP地址的长度为128，即有2^128 -1个地址。

- 2.更小的路由表。IPv6的地址分配遵循聚类原则，这使得路由器能在路由表中用一条记录表示一片子网，大大减少了路由器中路由表的长度，提高了路由器转发数据包的速度。

- 3.增强的组播支持以及对流的支持。这使得网络上的多媒体应用有了长足发展的机会，为服务质量控制提供了良好的网络平台，加入了对自动配置的支持。这是对DHCP的改进和扩展，使得网络的管理更加方便和快捷。

- 4.更高的安全性。在使用ipv6的网络中用户可以对网络层的数据进行加密并对IP报文进行校验，这极大地增强了网络安全。

![image](https://github.com/foxliang/Blog/blob/master/images/IPv62.png)


参考：

https://juejin.im/post/5de4875c6fb9a071ae38946f


